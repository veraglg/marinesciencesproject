---
embed-resources: true
---

# Results {#sec-results}

```{r}
#| label: setup
#| include: false
source("scripts/common.R")
```

## Visual inspection of recovered materials

Overall, compostable plastics remained unchanged compared to the pristine material for both benthic environments. They also conserved their original transparency and flexibility after they were thoroughly cleaned. Differences between Ecovio\textsuperscript{\textregistered} and conventional filter-paper recovered materials can be observed in @fig-visual. Cellulose broke down much more severely in lake than in the marine environment, suggesting that biodegradation occurs faster in the former. A blackish hue and brittleness were signs of severe degradation, to the point that some paper disks broke apart during recovery efforts. On the other hand, cellulose recovered from the seawater environment was significantly more preserved and only displayed a faint brownish tint, which can be attributed to a relatively less active microbial community compared to lake. Exceptionally, some individual Ecovio\textsuperscript{\textregistered} disks recovered from the freshwater environment showed small holes which might be due to biological degradation of the polymer.

::: {#fig-visual layout-ncol=2}
![lake](/images/visual-lake.jpg){width="7.25cm"}

![marine](/images/visual-sea.jpg){width="7.25cm"}

Recovered materials (Ecovio\textsuperscript{\textregistered} and paper) after 30 days.
:::

<!-- ![Recovered materials (Ecovio\textsuperscript{\textregistered} and paper) after 30 days, A: lake B: marine.](/images/results-visual.jpg){#fig-visual width="11cm"} -->

## Respirometric tests results

Generally, Ecovio\textsuperscript{\textregistered} tests exhibited BOD levels close to those observed in control (-C) tests. Conversely, positive control tests consistently demonstrated a rapid increase in BOD since the beginning of the incubation. The median BOD~30~, as well as the minimum-maximum range, are presented in @tbl-bod. Notably, marine tests showed a narrower range of variation compared to lake tests, which displayed greater heterogeneity between individual tests. No statistically significant response was detected for Ecovio\textsuperscript{\textregistered} tests in either the lake or marine environments (t-test, p-value > 0.05). Whereas, cellulose tests (+C) results were statistically significant in both environments (t-test, p-value < 0.05).

```{r}
#| label: tbl-bod
#| tbl-cap: BOD~30~ (mg O~2~ L^-1^), p-values from two-samples t-test (material, -C).

data |> filter(time == 30) |> 
  group_by(medium, test) |> 
  summarize(median = median(bod), min = min(bod), max = max(bod),
            .groups = "drop") |> 
  left_join(t_tests, by = join_by(medium, test)) |> 
  mutate(across(c(median, min, max), \(x) round(x, 2)),
         p.value = round(p.value, 5)) |> 
  mutate(test = fct_recode(test,
                           "(+C)" = "paper",
                           "Ecovio®" = "plastic",
                           "(-C)" = "control")
  ) |>
  gt() |> cols_label(p.value = "(p-value)") |> sub_missing() |> 
  cols_align("left", test)
```

@fig-bod illustrates BOD evolution for each environment. A positive respirometrical response was observed in cellulose (+C) after 10 and 20 days in the lake and marine environment, respectively. Surprisingly, Ecovio\textsuperscript{\textregistered} lake test remained consistently lower than control (-C). At sea, Ecovio\textsuperscript{\textregistered} maximum BOD approached that of cellulose (+C) after 20 days. Although this trend stabilized and finally disappeared at day 30.

```{r}
#| label: fig-bod
#| fig-cap: BOD evolution, median and min-max range.

data |> filter(time %% 5 == 0) |> ggplot(aes(time, bod)) +
  geom_point(aes(shape = test), stat = "summary", fun = median) +
  geom_ribbon(aes(fill = test), alpha = .3, linetype = 0,
              stat = "summary", fun.min = min, fun.max = max) +
  geom_line(aes(linetype = test), stat = "summary", fun = median) +
  facet_wrap(~ medium) +
  scale_linetype_manual(values = c("dotted", "solid", "dashed"),
                        labels = labels_test) +
  scale_shape_manual(values = c(0, 16, 1), labels = labels_test) +
  scale_fill_viridis_d(labels = labels_test) +
  labs(x = "time (days)", y = "BOD (mg/L)") +
  theme_classic() +
  theme(legend.position = "inside", legend.position.inside = c(.15, .8),
        legend.title = element_blank())
```

## Models comparison and ultimate biodegradability

@tbl-aic displays a performance summary for SEM and DEM models. The number of observations for each curve was the same, consisting of one measurement every 30 minutes. DEM had a median 33.27% lower AIC than SEM, showing a significantly higher model accuracy and an improved representation of the underlying biodegradation processes, even though they were marginally less successful at convergence.

```{r}
#| label: tbl-aic
#| tbl-cap: AIC performance metrics.

fits |> unnest(metrics) |> filter(isConv) |> group_by(model) |> 
  summarize(nobs = max(nobs), median = mean(AIC),
            min = min(AIC), max = max(AIC), n = n()) |> 
  mutate(conv_rate = n/24, .keep = "unused") |> 
  mutate(across(c(median, min, max), \(x) round(x, 2))) |> 
  gt() |> cols_label(nobs = md("$N$"), conv_rate = "convergence") |>
  fmt_percent(columns = conv_rate)
```

Ultimate BOD (BOD~L~) was estimated from the parameters of DEM, as summarized in @tbl-bodl. The median BOD~L~ for Ecovio\textsuperscript{\textregistered} and controls (-C) tests are nearly identical. The substantial difference between minimum and maximum BOD~L~ indicates high background test noise, which can be attributed to the complexity of environmental field samples.

```{r}
#| label: tbl-bodl
#| tbl-cap: BOD~L~ (mg O~2~ L^-1^) from DEM estimation.

fits |> unnest(params) |> filter(model == "DEM") |> 
  select(reactor, medium, test, term, estimate) |>
  pivot_wider(names_from = term, values_from = estimate) |> 
  mutate(l = if_else(reactor %in% no_conv, NA, l1 + l2)) |> 
  group_by(medium, test) |> 
  summarize(
    median = median(l, na.rm = T), min = na_min(l), max = na_max(l),
    n = sum(!reactor %in% no_conv),
    .groups = "drop"
  ) |> 
  mutate(across(c(median, min, max), \(x) round(x, 2))) |> 
  mutate(
    test = fct_recode(test,
                           "(+C)" = "paper",
                           "Ecovio®" = "plastic",
                           "(-C)" = "control")
  ) |>
  gt() |> cols_label(n = "(n)") |>
  cols_align("left", c(medium, test)) |> sub_missing()
```

@fig-fits illustrates the comparative performance of SEM and DEM in an Ecovio\textsuperscript{\textregistered} test simulating the marine environment. Overall, DEM demonstrated greater accuracy in adjusting to the measured BOD data, particularly at the beginning of the test. SEM degradation rate constant ($k$ = 0.14) was closer to that of the second term of DEM ($k_2$ = 0.03), which represents the most refractory components of the biodegradable organic matter. Moreover, the degradation rate constant from the labile components ($k_1$ = 5.22) was approximately 2 orders of magnitude higher than that of the second term ($k_2$ = 0.03) in the displayed SEM.

```{r}
#| label: fig-fits
#| fig-cap: SEM and DEM biodegradation curves over BOD data points from a single reactor (Ecovio\textregistered , marine).

fits_s05 <- fits |> filter(reactor == "S05")

params <- fits_s05 |> unnest(params) |>
  select(reactor, term, estimate) |>
  pivot_wider(names_from = term, values_from = estimate) |> 
  mutate(
    across(starts_with("l"), \(l) round(l, 0)),
    across(starts_with("k"), \(k) round(k, 2))
  )

fits_s05 |> unnest(data) |> ggplot(aes(time, bod)) +
  geom_line(alpha = .5) +
  geom_line(
    data = fits_s05 |> unnest(preds),
    aes(y = .fitted, color = model, linetype = model),
    linewidth = 1
  ) +
  scale_color_viridis_d(
    labels = c(
      "SEM" = bquote(BOD[t]==.(params$l)*(1-e^{.(params$k)*t})),
      "DEM" = bquote(BOD[t]==.(params$l1)*(1-e^{.(params$k1)*t})+
                                    .(params$l2)*(1-e^{.(params$k2)*t}))
    )
  ) +
  scale_linetype_manual(
    values = c("SEM" = "dashed", "DEM" = "solid"),
    labels = c(
      "SEM" = bquote(BOD[t]==.(params$l)*(1-e^{.(params$k)*t})),
      "DEM" = bquote(BOD[t]==.(params$l1)*(1-e^{.(params$k1)*t})+
                                    .(params$l2)*(1-e^{.(params$k2)*t}))
    )
  ) +
  labs(x = "time (days)", y = "BOD (mg/L)") +
  theme_classic() +
  theme(legend.position = "inside", legend.position.inside = c(.7, .2),
        legend.title = element_blank())
```
